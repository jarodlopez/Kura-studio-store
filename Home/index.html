<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kura Studio | home</title>
    
    <!-- TAILWIND CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- FONTS -->
    <link href="https://fonts.googleapis.com/css2?family=Syncopate:wght@400;700&family=Chakra+Petch:wght@300;400;500;600;700&family=Noto+Sans+JP:wght@100;400;900&display=swap" rel="stylesheet">

    <!-- FIREBASE (Solo lectura para configuración) -->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>

    <!-- REACT 18 -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- ICONS -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        :root {
            --neon-red: #ff003c;
            --acid-green: #ccff00;
            --cyber-black: #050505;
        }
        
        body { 
            background-color: var(--cyber-black); 
            color: white; 
            font-family: 'Chakra Petch', sans-serif; 
            overflow-x: hidden; 
            margin: 0; 
        }

        /* ANTI-FOUC (Ocultar hasta que cargue) */
        #root { opacity: 0; transition: opacity 0.8s ease-in; }
        #root.loaded { opacity: 1; }

        /* --- EFECTO TRUENO / LIGHTNING --- */
        .lightning-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white; z-index: 9999; opacity: 0; pointer-events: none;
        }
        .thunder-intro { animation: thunder-flash 1.5s ease-out forwards; }
        .thunder-exit { animation: thunder-flash-exit 0.8s ease-in forwards; }

        @keyframes thunder-flash {
            0% { opacity: 1; background: white; } 5% { opacity: 0; } 10% { opacity: 1; background: #fff; } 15% { opacity: 0; }
            30% { opacity: 0.8; background: #ccff00; } 40% { opacity: 0; } 100% { opacity: 0; pointer-events: none; }
        }
        @keyframes thunder-flash-exit {
            0% { opacity: 0; } 50% { opacity: 1; background: white; } 100% { opacity: 1; background: black; pointer-events: all; }
        }

        .glitch-text { position: relative; }
        .glitch-text::before, .glitch-text::after {
            content: attr(data-text); position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: transparent;
        }
        .glitch-text::before {
            left: 2px; text-shadow: -1px 0 var(--neon-red); clip: rect(24px, 550px, 90px, 0); animation: glitch-anim 3s infinite linear alternate-reverse;
        }
        .glitch-text::after {
            left: -2px; text-shadow: -1px 0 var(--acid-green); clip: rect(85px, 550px, 140px, 0); animation: glitch-anim 2s infinite linear alternate-reverse;
        }
        @keyframes glitch-anim {
            0% { clip: rect(13px, 9999px, 81px, 0); } 100% { clip: rect(10px, 9999px, 92px, 0); }
        }

        .btn-samurai {
            clip-path: polygon(20px 0, 100% 0, 100% calc(100% - 20px), calc(100% - 20px) 100%, 0 100%, 0 20px);
            transition: all 0.3s ease; text-transform: uppercase; letter-spacing: 0.2em;
        }
        .btn-samurai:hover {
            background: var(--neon-red); border-color: var(--neon-red); box-shadow: 0 0 30px rgba(255, 0, 60, 0.5);
            text-shadow: 0 0 5px white;
        }

        .vertical-text { writing-mode: vertical-rl; text-orientation: upright; font-family: 'Noto Sans JP', sans-serif; letter-spacing: 0.5em; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { createRoot } = ReactDOM;

        // Configuración por defecto (Fallback)
        const DEFAULT_CONFIG = {
            title: "KURA STUDIO",
            subtitle: "PREMIUM ANIME STREETWEAR",
            bgImage: "https://images.unsplash.com/photo-1614726365723-49cfae92782f?q=80&w=2602&auto=format&fit=crop", 
            logo: "", 
            btnText: "ENTRAR A LA TIENDA",
            storeUrl: "https://tu-tienda-kura.vercel.app", // AQUÍ ES DONDE REDIRIGE
            instagram: "#",
            whatsapp: "#"
        };

        const firebaseConfig = {
            apiKey: "AIzaSyAztg4F0twRi2NOP8MayAOUYB0ZtHgkss0",
            authDomain: "kodialabsnic.firebaseapp.com",
            projectId: "kodialabsnic",
            storageBucket: "kodialabsnic.firebasestorage.app",
            messagingSenderId: "740746852984",
            appId: "1:740746852984:web:972aa34592aef881630b8d"
        };

        let db;
        try {
            if (window.firebase && !firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
                db = firebase.firestore();
            } else if (window.firebase) db = firebase.firestore();
        } catch (e) { console.error(e); }

        const Icon = ({ name, className }) => {
            useEffect(() => { if (window.lucide) window.lucide.createIcons(); });
            return <i data-lucide={name} className={className}></i>;
        };

        const LandingPage = () => {
            const [config, setConfig] = useState(DEFAULT_CONFIG);
            const [animState, setAnimState] = useState('intro');

            useEffect(() => {
                // Cargar config de Firebase
                if (db) {
                    db.collection('settings').doc('landing_page_v2').onSnapshot(doc => {
                        if (doc.exists) setConfig({ ...DEFAULT_CONFIG, ...doc.data() });
                        document.getElementById('root').classList.add('loaded');
                    });
                } else {
                    document.getElementById('root').classList.add('loaded');
                }
                
                // Animación inicial
                const t = setTimeout(() => setAnimState('idle'), 1500);
                return () => clearTimeout(t);
            }, []);

            const handleEnter = () => {
                setAnimState('exit');
                // Redirección después de la animación de trueno
                setTimeout(() => {
                    // Si hay URL en firebase usa esa, sino la por defecto
                    const target = config.storeUrl || "/tienda"; 
                    window.location.href = target;
                }, 800);
            };

            return (
                <div className="relative w-full min-h-screen flex flex-col justify-center items-center overflow-x-hidden py-12 md:py-0">
                    
                    {/* LAYERS DE TRUENO */}
                    <div className={`lightning-overlay ${animState === 'intro' ? 'thunder-intro' : ''} ${animState === 'exit' ? 'thunder-exit' : ''}`}></div>

                    {/* FONDO */}
                    <div className="fixed inset-0 z-0">
                        <div className="absolute inset-0 bg-black/50 z-10"></div>
                        <img src={config.bgImage} className="w-full h-full object-cover transition-transform duration-[20s] hover:scale-110 animate-pulse" />
                    </div>

                    {/* DECORACIÓN LATERAL */}
                    <div className="fixed right-10 top-0 bottom-0 z-10 hidden md:flex flex-col justify-center items-center pointer-events-none mix-blend-overlay">
                        <div className="w-[1px] h-32 bg-white/50 mb-8"></div>
                        <span className="vertical-text text-4xl font-black text-white/30">クラスタジオ</span>
                        <div className="w-[1px] h-32 bg-white/50 mt-8"></div>
                    </div>

                    {/* CONTENIDO CENTRAL */}
                    <div className="relative z-20 flex flex-col items-center justify-center w-full px-4 text-center my-auto">
                        <p className="text-[#ccff00] font-mono text-[10px] md:text-sm mb-4 tracking-[0.3em] animate-pulse">EST. 2026 // SYSTEM ONLINE</p>
                        
                        {/* LOGO + TITULO */}
                        <div className="flex flex-col md:flex-row items-center gap-4 md:gap-8 mb-4">
                            {config.logo && (
                                <div className="w-24 h-24 md:w-32 md:h-32 rounded-full border-2 border-[#ff003c] overflow-hidden shadow-[0_0_20px_#ff003c] bg-black">
                                    <img src={config.logo} className="w-full h-full object-cover" alt="Logo"/>
                                </div>
                            )}
                            <h1 className="text-4xl sm:text-6xl md:text-9xl font-black font-['Syncopate'] text-white glitch-text tracking-tighter leading-none" data-text={config.title}>
                                {config.title}
                            </h1>
                        </div>
                        
                        <p className="text-gray-300 font-mono text-xs sm:text-sm md:text-xl mb-12 max-w-xs sm:max-w-lg tracking-widest border-l-2 border-[#ff003c] pl-4 mx-auto">
                            {config.subtitle}
                        </p>

                        <button 
                            onClick={handleEnter}
                            className="btn-samurai bg-transparent border-2 border-white text-white px-8 py-4 md:px-12 md:py-5 font-bold font-['Chakra_Petch'] text-sm md:text-xl relative group overflow-hidden touch-manipulation"
                        >
                            <span className="relative z-10 flex items-center gap-3">
                                {config.btnText} <Icon name="zap" className="group-hover:text-black transition-colors w-4 h-4 md:w-6 md:h-6"/>
                            </span>
                            <div className="absolute inset-0 bg-[#ff003c] transform -translate-x-full group-hover:translate-x-0 transition-transform duration-100 ease-out z-0"></div>
                        </button>
                    </div>

                    {/* FOOTER */}
                    <div className="relative md:absolute bottom-0 md:bottom-10 left-0 w-full flex justify-center gap-8 z-20 mt-12 md:mt-0 pb-8 md:pb-0">
                        <a href={config.instagram} target="_blank" className="text-white hover:text-[#ff003c] transition-colors"><Icon name="instagram"/></a>
                        <a href={config.whatsapp || "#"} target="_blank" className="text-white hover:text-[#25D366] transition-colors"><Icon name="message-circle"/></a>
                    </div>
                </div>
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<LandingPage />);
    </script>
</body>
</html>
